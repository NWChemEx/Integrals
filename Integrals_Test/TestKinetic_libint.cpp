#include <Integrals/LibintIntegral.hpp>
#include "TestCommon.hpp"

using namespace Integrals::Libint;

//Computes the kinetic energy integrals for water in STO-3G
static BlockTensor corr{
    {{0 , 0}, {29.0031999455395848,}},
    {{0 , 1}, {-0.1680109393164922,}},
    {{0 , 2}, {0.0000000000000000,0.0000000000000000,0.0000000000000000,}},
    {{0 , 3}, {-0.0084163851854474,}},
    {{0 , 4}, {-0.0084163851854474,}},
    {{1 , 0}, {-0.1680109393164923,}},
    {{1 , 1}, {0.8081279549303477,}},
    {{1 , 2}, {-0.0000000000000000,0.0000000000000000,0.0000000000000000,}},
    {{1 , 3}, {0.0705173385189988,}},
    {{1 , 4}, {0.0705173385189988,}},
    {{2 , 0}, {0.0000000000000000,0.0000000000000000,0.0000000000000000,}},
    {{2 , 1}, {-0.0000000000000000,0.0000000000000000,0.0000000000000000,}},
    {{2 , 2}, {2.5287311981947651,0.0000000000000000,0.0000000000000000,
               0.0000000000000000,2.5287311981947642,0.0000000000000000,
               0.0000000000000000,0.0000000000000000,2.5287311981947651,}},
    {{2 , 3}, {0.1149203802569082,0.0000000000000000,0.1470905524127557,}},
    {{2 , 4}, {0.1149203802569082,0.0000000000000000,-0.1470905524127557,}},
    {{3 , 0}, {-0.0084163851854474,}},
    {{3 , 1}, {0.0705173385189988,}},
    {{3 , 2}, {0.1149203802569082,0.0000000000000000,0.1470905524127557,}},
    {{3 , 3}, {0.7600318835666090,}},
    {{3 , 4}, {-0.0039797367270372,}},
    {{4 , 0}, {-0.0084163851854474,}},
    {{4 , 1}, {0.0705173385189988,}},
    {{4 , 2}, {0.1149203802569082,0.0000000000000000,-0.1470905524127557,}},
    {{4 , 3}, {-0.0039797367270372,}},
    {{4 , 4}, {0.7600318835666090,}}};

TEST_CASE("Testing Libint's Kinetic Energy Integrals class"){
    auto [molecule, bs] = make_molecule();
    Kinetic TBuilder;
    auto T = TBuilder.run(molecule, {bs, bs});
    print_integrals(T);
    compare_integrals(T, corr);
}
